# Git学習メモ
## Gitコマンド

-ローカルリポジトリを作る
　-git init
  -ファイルの状態を確認
    -git status
  -ファイルを登録する
    -git add
  -ワークエリアのファイルを最新コミットした内容に戻す
    -git restore <file>...
  -ステージエリアのファイルを取り消す(最新コミットした内容に戻す)
    -git restore --staged <file>...
  -ファイルの削除
   -git rm ファイル名(remove_me.txt)
  -デレクトリの削除
  　-git rm -r ディレクトリ名(subDirectory)

  -SSH　Keyを生成する
   -$ SSH-keygen -t rsa -b 4096 -C "digilabo0601@gmail.com"

  -Chapter４　
  -Githubに公開しているリモートリポジトリを複製して自分のリモートリポジトリを作成する(フォークする)
  　-(例)複製元のリポジトリをフォークを開始する
    -(1)  https://github.com/yasagit/ichiyasaGitSample
    -(2) 画面右上にある[Fork]をクリックする
    -(3) フォークが完了すると画面左上の内容が自分のリポジトリに移っています。

  -リモートリポジトリをローカルリポジトリに複製する(クローン)
    -リモートリポジトリをクローンする
      -(1) GitHubで、リポジトリのメインページにアクセスしてください。
      -(2) ファイルのリストの上にある Code（コード）をクリックしてください。
      -(3) HTTPS SSH CLI のURLをコピーし、下記のコマンドをホームディレクトリ(cd ~)で実行する
      -git clone https://github.com/b2b-inc/ichiyasaGitSample.git

    -クローンされたリポジトリに移動する
    　-cd ichiyasaGitSample
    -リモートリポジトリの設定を確認
    　-git remote -v
       「origin」という文字の後に先ほど指定したURLが2回表示されます。
  
  **** ワンポイント　アドバイス  *****
   .gitignoreファイルのテンプレート
    さまざまなプログラミング言語やツールのための.gitignoreファイルのテンプレート
    をGitHub社がオープンソースで公開しています。
    (https://github.com/github/gitignore)

 
  -Chapter５　GitHubの使用方法
    -ブランチとは・・・Gitで記録する履歴を枝分かれさせるための機能です。
    -マージ・・・・・・枝分かれさせたブランチを任意のタイミングで統合すること。
    -masterブランチ・・ローカルリポジトリを作成時に自動で作られる、masterというブランチです。gitで管理する主軸のブランチ。

    -ブランチを使った事例
    　-ブランチを使ってイベント会場情報を更新する。
    　  -chapter４でローカルリポジトリに取得したサンプルプロジェクト(ichiyasaGitSample)を編集しながら進めます。
    　　-(1)ブランチを作成する
    　　    - git branch ブランチ名
              git branch update-venue
        -(2)使用中のブランチを確認する
        　　-git branch  又は　git status　　※デフォルトではmasterブランチになっている
        -(3)ブランチを切り替える(チェックアウト)
            -git checkout ブランチ名
             git checkout update-venue
        -(4)使用中のブランチを確認する
            -git branch  又は　git status
        -(5)index.htmlを編集する
            -index.htmlの株式会社〇〇 -> 株式会社インプレス　に変更
        -(6)状態を確認する
            -git status
             index.htmlが「modified」になっていることを確認
        -(7)変更をコミットする
            -git add index.html
             git commit -m "イベント会場を株式会社インプレスに更新"
        -(8)masterブランチとの差分を確認
            -git diff master
             =>会場変更が反映されていることが確認出来るはずです。

            ※git diffコマンドを使うとブランチ同志の差分比較をすうことが出来ます。

         *******************************************
         これでupdate-venueブランチでの作業は完了です。
         *******************************************

        -(8)ローカルリポジトリをリモートリポジトリに反映する
            -git push プッシュ先のリモートリポジトリ名 プッシュするブランチ名
             gir pushu origin update-venue
        -(9)プルリクエストを作成し変更内容をチームにレビューしてもらう
             詳細な操作については割愛します。ここでは手順のみ記述します。
             　　1.msterブランチへのプルリクエスト作成を開始する。
             　　2.レビュー対象のブランチ、ベースブランチを正しく選択する。
                 3.トピックブランチ・・・レビューの対象としたいブランチ
                 　　　　　　　　　　　　　b2b-inc/ichiyasaGitSample  update-venue
                    ベースブランチ・・・・マージ先のブランチ(通常masterブランチ)
                                        b2b-inc/ichiyasaGitsample   master
                4.プルリクエストに必要な情報を入力する
                   タイトル：イベント会場を「株式会社インプレス」に更新
                   コメント：＃＃＃変更内容
                   　　　　　「株式会社インプレス」さんがイベント会場を提供してくださるこ　　　　　　とになりました。
                5.Reviewersにレビューしてもらう人をしてする。
                  ※レビューアーとなるには権限が必要です。
                6.プルリクエストの内容を確定する。
                　　最期に「Create pull request」をクリックすればプルリクエストの作成が　　完了します。
                7.プルリクエストをレビューしてもらう
                　　レビュー結果の種類
                　　　・Comment  　　　　: 承認せずにコメントだけ付ける。
                　　　・Appprove 　　　　: 承認する。
                　　　・Request changes ：修正依頼する　

                　　※修正依頼がある場合
                　　　ローカルリポジトリの修正->git add -> git commit -> git push を繰　　　り返す。
        -(10)GitHub（リモートリポジトリ)上でブランチをマージする
             -「Merge pull resuest」の「▼」をクリック「
             -「Create a merge commit」を選択　
             　　※基本はこれを選択する
             　　「create a merge commir」
             　　=>トピックブランチに加えたコミットがすべてベースブランチにマージされます。
             　　「Squash and merge」
            　　　=>トピックブランチで追加したコミットを１つのコミットにまとめたあとでマージします。
              　　「rebase and merge」
              　　　=>ブランチの枝分かれ元を最新コミット位置に変更(リベース)してからマージしす。
             　　　　
             -「Merge pull request」をクリック
        -(11)リモートリポジトリの内容をローカルリポジトリに取り込む方法
             -２つの選択肢「プル」と「フェッチ」
             　-pull(プル) : 取得内容がワークツリーまで反映され、パソコン内のファイルが即座に書きかわります。　　　　　
               -fetch(フェッチ) : ローカルリポジトリへの取得しか行わないので、ワークツリーに反映させるいは再度プルを行う
               　　　　　　　　　　かマージを行う必要があります。
               　※「プル」 = 「フェッチ」 + 「マージ」
             -リモートからローカルに反映するコマンド
              -カレントブランチを確認
                -git branch  又は　git status
              - masterブランチに切り替える
                 - git checkout master
              -git pullコマンドを実行する
               git pull プル先のリモートリポジトリ名 プルするブランチ名
               gir pull origin master

       **********************************************************************************************************
       * 不要なブランチをコマンドで削除しよう                                                                      *
       *    +-------------------------------------------------------------------------------------------+       *
       *    | 操作対象のリポジトリ　| 操作内容　　　　　　　　　　　　| コマンド　　　　　　　　               |       *
       *    +-------------------------------------------------------------------------------------------+       *        
       *    | ローカルリポジトリ    | マージ済みのブランチを削除する  |  git branch --delete sessions-info  |       *
       *    |                     |                               |  git branch -d sessions-info        |       *
       *    +---------------------|-------------------------------|-------------------------------------+       *
       *    | ローカルリポジトリ    | マージ状況に関わらずブランチを  |                                      |      *
       *    |                     |  削除する                      |  git branch -D session-info         |       *
       *    +---------------------|-------------------------------|--------------------------------------+       *
       *    | リモートリポジトリ    | ブランチを削除する             |  git push --delete origin seons-info |       *
       *    +----------------------+------------------------------+--------------------------------------+       *
       *                                                                                                         *
       ***********************************************************************************************************    

  -Chapter６　複数のブランチを同時に使うときの使用方法
  　-作業概要
  　　(1)１つ目のブランチ(speakers-info)を用いてスピーカー情報を更新する
  　　　　イベントで講演するスピーカーが決まったため、イチヤサさんは専用のブランチを作成してイベントページにスピーカーのプロフィール
  　　　　文と画像を追加します。なお、サンプルとして登場するスピーカーは「いろふさん」と「うらがみさん」です。
  　　　　しかし、いろふさんのプロフィール画像がまだ手に入っていません。そのためいろふさんの画像追加はＴＯＤＯコメントを書き、仮の画像をセット。
  
   　　(2)２つ目のブランチ(sessions-info)でセッション情報を更新する。
   　　　　スピーカー情報の更新は途中のままにし、セッション情報を更新します。ただし、作業の目的や内容が異なるため、使用するスピーカー情報用と別のブランチ
   　　　　です。

   　　(3)１つ目のブランチ(speakers-info)に戻り、スピーカー情報の更新を終える。
   　　　　セッション情報の更新中に、いろふさんのプロフィール画像が手に入ったとします。まず２つ目のブランチで加えた変更を１つ目のブランチに反映させましょ　　　　う。その後、１つ目のブランチで画像の追加(仮の画像と差し替え)とＴＯＤＯコメントの削除を行い、コミットとマージを行います。

   -作業手順
   　　-スピーカー情報を途中まで更新する
   　　　(1)ブランチを作成し、チェックアウトする
   　　　　　-git checkout -b speakers-info

              ※git branchコマンドでブランチを作成し、
              　git checkoutコマンドで作成したブランチに切り替えるのを1つのコマンドで出来ます。

              　git checkout -b speakers-info

         (2)ＨＴＭＬを更新する
             -１人目のスピーカー(いろふさん)の編集
         　　　-<div class="speaker">以下を仮の画像(speaker1.png)編集
                  <!-- TODO : プロフィール画像を受取ったら更新する -->
                  <img src="images/speaker1.png" alt="" class="image" />

               -<div class="inner">以下を編集する
                  <h4>いろふさん</h4>
                  <p>大阪を中心に仕事をしている。普通のプログラマーです。</p>
                  <p>関西Ｊａｖａエンジニアの会の中の人</p>
                  <p>主に業務Ｗｅｂアプリの開発をしてきました。</p>

            -２人目のスピーカー(うらがみさん)の編集
         　　　-<div class="speaker">以下を仮の画像(speaker2.png)編集
                  <img src="images/speaker2.png" alt="" class="image" />

               -<div class="inner">以下を編集する
                  <h4>うらがみさん</h4>
                  <p>大阪のプログラマーです。GitHubを日常的に使用しています。</p>
                  <p>一年間毎日コミットをして<プロフィールページのcontoributionsを緑一色にしたことがあります。</p>

          (3)画像を追加する
             -画像保存場所--tmpフォルダ>Git Doc
             -ｃ>ユーザー>0102>ichiyasaGitSample>images フォルダにドラッグアンドドロップする。

          (4)ブラウザで編集後を確認する
          (5)編集したファイル(index.html)、画像(speaker1.png,speaker2.png)をコミットする
             -git status で状態確認
             　・ブランチがspeakers-infoであることを確認
               ・index.htmlが「modified」と表示されていることを確認
               ・新たに追加した画像(speaker1.png, speker2.png)が「untacked」と表示されていることを確認
              -ステージングエリアへ追加
              　-git add -A

                 ※-Aオプションは新規追加・編集・削除したすべてのファイルを一度にステージングエリアへ追加します。
                   -Aは、--allとも書けます。

              -ステージングエリアに追加されたことを確認
              　-git status

              -コミットを実行
                -git commit -m "スピーカー情報の追記した"

              -リモートリポジトリにspeakers-infoブランチを反映（プッシュ)する
                -git push origin speakers-info

      -セッション情報を更新
          次にセッション情報(タイムテーブル)を更新しましょう。別の作業になるのでセッション情報専用のsessions-infoブランチを作成します。
          現在は先ほど作ったspeakers-infoブランチの状態ですので、一度masterブランチに戻ってそこから別のブランチを作成しましょう。
      　  (1)新たなブランチ(sessions-info)をmasterブランチから作成する。
             -git checkout master
              git checkout -b sessions-info

          (2)ファイル(index.html)を編集し、マージまで進める
             -<h3>タイムテーブル</h3>以下の記述のところを編集する
             <td>19:05～19:50</td>
             <td>わたしのGitの使い方(いろふさん)</td>
 
             <td>20:00～20:45</td>
             <td>現場で使える！実践Git(うらがみさん)</td>

          (3)ブラウザで編集後を確認する
          (4)変更をコミットする
             -git status
              git add index.html
              git commit -m "セッション情報を記載した"

          (5)リモートリポジトリにプッシュ
             -git push origin sessions-info

          (6)マージする
             -プルリクエストを使ってマージする

      -スピーカーブランチに戻り、作業を再開する
          今度はspeakers-infoブランチに切り替えてスピーカー情報の続きをしていきます。
          ただし、masterブランチには、先ほどのsessions-infoブランチで行った編集作業内容が含まれています。
          speaker-infoブランチには、セッション情報が含まれていません。
          そのため、speakers-infoブランチに最新のmasterブランチの内容を含めるように更新してから、作業を行います。
      　　 (1)セッション情報編集ではリモートリポジトリ上でmasterブランチにマージをしたため、それはまだローカルリポジトリに反映していません。
      　　　　git pullを使ってローカルリポジトリのmasterブランチを最新」状態にします。
      　　　　 -git checkout master
              -git pull origin master
          
          (2)スピーカー情報ブランチ(speakers-info)に切り替える
      　　　　-git checkout speakers-info

          (3)masterブランチから最新状態を取り込む
             -git merge master

          (4)HTMLを更新する
          　　TODOコメントを削除
             スピーカーのimagesファルダにあるプロフィール画像を仮画像(speaker1.png)から本画像(speaker1.png)に変える

          (5)変更をコミットする
             今回はステージングエリアの追加とコミットを一度に行ってみます。
             -git status
               index.htmlと画像が「modified」になっています

             -git commit -am "いろふさんのプロフィール画像を追加"
              ※-aオプションはステージエリアに追加して、そのままコミットします。

          (6)リモートリポジトリにプッシュ
             -git push origin speakers-info

          (7)マージする
          　　-プルリクエストを使ってマージする

  -Chapter７　複数人で並行作業での問題(コンフリクト)発生の対処方法
  　-コンフリクトとは何か
  　　マージする２つのブランチがそれぞれ同じファイルの同じ箇所に異なる変更を加えた場合、
  　　Gitはマージの仕方を判断することが出来ません。このような現象が発生することをコンフリクトと言う。
  　　コンフリクトが起きたら、人がマージ後の正しい結果を判断し手動で修正しマージを行う必要があります。

  　　※これを回避するには、最初から複数人で同じファイルを同時に修正しないようにすることである。
  　
  　-作業概要
  　　ここではわざとコンフリクトを発生させ、解消します。
  　　うらがみさんのセッションタイトルが変更となったため、イチヤサさんはタイムテーブルを更新するためにmasterブランチ
  　　からトピックブランチを作成し、コミットとプルリクエストを行います。ところがセッション情報を更新用ブランチ(change-session-title)
  　　のレビューを終えマージするよりも先に、ヤマグチさんが作業していたブランチがmasterにマージされたとしましょう。
  　　どうやらヤマグチさんはタイムテーブルのレイアウトを変更し、タイムテーブルに進行/スピーカー項目を新たに追加したようです。

  　　リモートリポジトリの最新のmasterブランチを取り込みローカルリポジトリのmasterブランチを最新化し、
      セッション情報更新用ブランチ(change-session-title)にマージしようとするとコンフリクトが発生します。

      -イチヤサさんの作業
      　(1)ブランチの作成
      　　　-git checkout -b change-session-title

        (2)セッションタイトルを書き換える
        　　<td>現場で使える実践Git(うらがみさん)</td>  -->  <td>めざせ脱初心者!現場で使える実践Git(うらがみさん)</td>

        (3)コミットして、プッシュする
          -git commit -am "うらがみさんのセッションタイトルを更新"
           git push origin change-session-title

       　※コンフリクトを発生させるため、マージは行いません。

      -ヤマグチさんの作業
      　　通常は、トピックブランチを作成してタイムテーブルのレイアウトを変更し、masterブランチにマージした後の状態を作り出します。
      　　ここでは手順をシンプルにするためリモートリポジトリのmasterブランチにあるファイル(index.html)を直接編集します。
        (1)GitHubでファイルの編集画面を開く
        　　ブラウザでgitHub上にあるリモートリポジトリの画面を開き、ファイル一覧からindex.htmlをクリックします。
        　　これでGitHub上の画面にindex.htmlの内容が表示されます。
        　　ファイルの右上にある鉛筆の「Edit this file」ボタンをクリックすると、ブラウザ上で編集ができます。

        (2)タイムテーブルの編集--列の追加

        　　<th>進行 / スピーカー</th> <----追加
           
            <td>19:00～19:05</td>
            <td>スタフ</td>            <----追加
            <td>オープニング</td>

            <td>19:05～19:50</td>
            <td>いろふさん</td>        <----追加
            <td>私のGitの使い方</td>

            <td>19:50～19:20:00</td>
            <td> - </td>              <----追加
            <td>休憩</td>

            <td>20:00～20:45</td>
            <td>うらがみさん</td>      <----追加
            <td>現場で使える実践Git</td>

            <td>20:45～21:00</td>
            <td>スタッフ</td>         <----追加
            <td>クロージング</td>

            <td>21:00～  </td>
            <td> - </td>                 <----追加
            <td>懇親会</td>          　

        (3)変更をコミット
        　　編集が完了したら、下の方にスクロールしていくと「Commit changes」というフォームが現れます。
          　-ここでコミットメッセージを入力します。
          　-「Commit directly to the master branch」が選択されていることを確認。
          　「Commit changes」をクリックし確定させます。

      -イチヤサさんの作業
      　(1)ローカルリポジトリのmasterブランチを最新化する
           -git checkout master
           -git pull origin master

        (2)change-session-titleブランチにmasterブランチをマージする
           -git checkout change-session-title
           -git merge master

           ==>コンフリクトが発生メッセージが表示されます。
              CONFLICT(content): Merge conflict in index.html
              automatic merge failed: fix conflicts and then commit the result.

              ※コンフリクト発生時にファイルの状態を表すメッセージとして
                both modified以外に「deleted by them」や「added by you」などと表示されることがあります。

        (3)コンフリクトの発生を確認する
           git statusコマンドを実行すると、その結果コンフリクトの発生を確認することができます。
           -git status
            「both modified: index.html」と表示されます。

        (4)GitHub上で確認する
        　　GitHub上のプルリクエストの画面でもコンフリクトを確認することができます。
        　　change-session-titleブランチのプルリクエストを見ると「This branch has conflicts that must be resoled」
        　　(解消しなけれがならないコンフリクトがらる)と表示され、マージが未完了となっているはずです。

        (5)コンフリクトの原因となっているところを特定し、正しい内容に編集し直す
           -Visual Studio codeでindex.htmlを開く。
           -タイムテーブルを見ると、連続する<<<と>>>、そして===で囲まれた部分が見つかると思います。
            <<<の行から>>>の行までがコンフリクトしている箇所です。
            ===の行がマージ先とマージ元の変更箇所の境目です。

          -ファイルの内容を正しく修正しましょう
          　ヤマグチさんが変更したタイムテーブルの形式に合わせて、うらがみさんのセッションタイトルを更新した状態に修正します。

            ※コンフリクトの印である記号は、忘れずに削除してください。

          -修正結果をブラウザで確認しておきましょう。

        (6)ステージエリアに追加
           -git add -A     ※ -Aは--allと同じ

        (7)状態確認
          -git status
           「All conflicts fixed but you are still merging.(use "git commit to conclude merge」
            (コンフリクトは解消したが、マージは終わっていません。コミットを行ってマージを完了させよ)と表示しています。
            ==>コンフリクトにより失敗したマージは、解消ししてコミットを行うまで、マージしている最中(マージ未完)のままとなります。

        (8)マージを完了する
           コミットを行うことでマージを完了させます。
           -git commit    ※パラメータなしでコミット

           ※コミットメッセージ編集用画面が開きますが、編集せずに閉じます。

        (9)リモートリポジトリにプッシュする
        　　-git push origin change-session-title

        (10)プルリクエストを確認する
        　　GitHub上でプルリクエストをを確認すると、自動でのマージが出来るようになっています。
        　　-レビューをしてもらい
        　　-「Merge pull request」をクリックしてマージ。



        
        　　
           

    


              
                 　


                 
         　　　　　
   　　　

             
             　　　

                　　　　
            
                                  





   